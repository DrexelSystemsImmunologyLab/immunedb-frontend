<div class="header">
  <ol class="breadcrumb">
    <li><a href="#/studies">Studies</a>
    </li>
    <li>Sample Comparison</li>
  </ol>
</div>

<div class="alert alert-warning" role="alert" ng-show="missing.length > 0"><strong>Warning</strong> The following samples do not have statistical information, or do not exist:
  <ul>
    <li ng-repeat="m in missing">Sample #{{ m }}</li>
  </ul>
</div>
<h3>Basic Statistics</h3>
<div class="table-responsive">
  <table class="table table-bordered">
    <thead>
      <tr>
        <th># <a data-toggle="tooltip" title="A globally unique ID for this sample"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Name <a data-toggle="tooltip" title="A name for the sample"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Total <a data-toggle="tooltip" title="Total sequences in the sample"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Valid <a data-toggle="tooltip" title="Sequences which have V and J regions that match a germline"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Invalid <a data-toggle="tooltip" title="Sequences which have V and J regions that do not match a germline"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>In-frame <a data-toggle="tooltip" title="Sequences which have a number of nucleotides divisible by three"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Functional <a data-toggle="tooltip" title="Sequences which are in-frame and contain no stop codons"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Unique <a data-toggle="tooltip" title="Unique sequences"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Unique CN &gt; 1 <a data-toggle="tooltip" title="Unique sequences with copy number greater than one"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Clones <a data-toggle="tooltip" title="Number of clones"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
        <th>Funct. Clones <a data-toggle="tooltip" title="Number of functional clones"><span class="glyphicon glyphicon-question-sign"></span></a>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="stat in meta">
        <td>{{ stat.sample.id }}</td>
        <td>{{ stat.sample.name }}</td>
        <td>{{ stat.sample.valid_cnt + stat.sample.no_result_cnt | number}}</td>
        <td>{{ stat.sample.valid_cnt | number }}</td>
        <td>{{ stat.sample.no_result_cnt | number }}</td>
        <td>{{ 100 * stat.all.in_frame_cnt / stat.sample.valid_cnt | number : 2}}%</td>
        <td>{{ 100 * stat.sample.functional_cnt / stat.sample.valid_cnt | number : 2}}%</td>
        <td>{{ stat.unique.sequence_cnt | number }}</td>
        <td>{{ stat.unique_multiple.sequence_cnt | number }}</td>
        <td>{{ stat.clones_all.sequence_cnt | number }}</td>
        <td>{{ stat.clones_functional.sequence_cnt | number }}</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 ng-init="filter='Unique with Copy Number > 1'">Feature Distributions: <i>{{ filter }}</i></h3>
<ul class="nav nav-pills" role="tablist" id="funcTab">
  <li class="dropdown">
    <a role="button" data-toggle="dropdown">Clones <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      <li>
        <a href="#clones_all" role="tab" data-toggle="tab" ng-click="filter='All Clones'">
          <span class="badge pull-right">{{ cnts.clones_all | formatNumber }}</span>All
        </a>
      </li>
      <li>
        <a href="#clones_functional" role="tab" data-toggle="tab" ng-click="filter='Functional Clones'">
          <span class="badge pull-right">{{ cnts.clones_functional | formatNumber }}</span>Functional
        </a>
      </li>
      <li>
        <a href="#clones_nonfunctional" role="tab" data-toggle="tab" ng-click="filter='Non-Functional Clones'">
          <span class="badge pull-right">{{ cnts.clones_nonfunctional | formatNumber }}</span>Non-Functional
        </a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a role="button" data-toggle="dropdown">Unique <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      <li>
        <a href="#unique" role="tab" data-toggle="tab" ng-click="filter='All Unique'">
          <span class="badge pull-right">{{ cnts.unique | formatNumber }}</span>All
        </a>
      </li>
      <li>
        <a href="#unique_multiple" role="tab" data-toggle="tab" ng-click="filter='Unique with Copy Number > 1'">
          <span class="badge pull-right">{{ cnts.unique_multiple | formatNumber }}</span>Copy # > 1
        </a>
      </li>
    </ul>
  </li>

  <li class="dropdown">
    <a role="button" data-toggle="dropdown">Functionality <span class="caret"></span></a>
    <ul class="dropdown-menu" role="menu">
      <li>
        <a href="#functional" role="tab" data-toggle="tab" ng-click="filter='Functional'">
          <span class="badge pull-right">{{ cnts.functional | formatNumber }}</span>Functional
        </a>
      </li>
      <li>
        <a href="#nonfunctional" role="tab" data-toggle="tab" ng-click="filter='Non-Functional'">
          <span class="badge pull-right">{{ cnts.nonfunctional | formatNumber }}</span>Non-Functional
        </a>
      </li>
    </ul>
  </li>

  <li>
    <a href="#all" role="tab" data-toggle="tab" ng-click="filter='All'"><span class="badge pull-right">{{ cnts.all | formatNumber }}</span> All</a>
  </li>
</ul>

<div class="tab-content">
  <filtered-panel
    filter="clones_all"
    heatmap="vHeatmapClonesall"
    charts="charts.clones_all"
    clones="clone_pager.clones_all"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="clones_functional"
    heatmap="vHeatmapClonesfunctional"
    charts="charts.clones_functional"
    clones="clone_pager.clones_functional"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="clones_nonfunctional"
    heatmap="vHeatmapClonesnonfunctional"
    charts="charts.clones_nonfunctional"
    clones="clone_pager.clones_nonfunctional"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    tclass="tab-pane in active"
    filter="unique_multiple"
    heatmap="vHeatmapUniquemultiple"
    charts="charts.unique_multiple"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="unique"
    heatmap="vHeatmapUnique"
    charts="charts.unique"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="functional"
    heatmap="vHeatmapFunctional"
    charts="charts.functional"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="nonfunctional"
    heatmap="vHeatmapNonfunctional"
    charts="charts.nonfunctional"
    pager="updateClone"></filtered-panel>

  <filtered-panel
    filter="all"
    heatmap="vHeatmapAll"
    charts="charts.all"
    pager="updateClone"></filtered-panel>
</div>
